<div class="grid">
	<div class="col-12">
		<div class="mx-2 py-2">
			<h4>
				<i class="bi bi-send-exclamation"></i>
				Assessorias Pendentes
			</h4>
		</div>
		<div class="card">
			<p-dataView
				#dv
				[value]="consultancyService.consultancies"
				[rows]="10"
				[paginator]="true"
				[lazy]="true"
        [emptyMessage]="'Você não possui pendências!'"
        [alwaysShowPaginator]="false"
				(onLazyLoad)="consultancyService.loadPendingConsultancies($event)"
				[totalRecords]="consultancyService.totalRecords"
				[showCurrentPageReport]="true"
				currentPageReportTemplate="{first} a {last} de {totalRecords} assessoria(s)"
			>
				<ng-template pTemplate="list">
					<div class="grid grid-nogutter gap-1">
						<div
							class="col-12 dv-list border-1 surface-border border-round"
							*ngFor="let item of consultancyService.consultancies"
						>
							<div
								class="flex flex-column xl:flex-row xl:align-items-start p-4 gap-4"
							>
								<div
									class="flex flex-column sm:flex-row justify-content-between align-items-stretch flex-1 gap-4"
								>
									<div
										class="flex flex-column align-items-center sm:align-items-start gap-3"
									>
										<div class="w-full text-sm text-900 flex align-self-start justify-content-between">
											<span>
												<i class="bi bi-send"></i>
												{{ item.id }}
											</span>
                      <span 
                      class="p-error sm:hidden"
                      [pTooltip]="item.status_assessoria?.nome"
                      tooltipPosition="top"
                      appendTo="body"
                      >
												<i class="bi bi-exclamation-triangle"></i>
											</span>
										</div>
										<div class="text-xl text-900">
											<span class="mx-2">{{ item.tipo_assessoria?.nome }}</span>
										</div>
										<div class="flex align-items-center gap-3">
											<span class="flex align-content-end gap-2">
												<i class="pi pi-user"></i>
												<span>
													<span class="font-semibold mr-1">
														{{ costumer ? 'Funcionario' : 'Cliente' }}:
													</span>
													{{ costumer ? item.funcionario?.nome_completo : item.cliente?.nome_completo }}
												</span>
											</span>
										</div>
									</div>
									<div
										class="flex justify-content-center sm:justify-content-between flex-column align-content-between gap-5 sm:gap-2"
									>
										<div class="flex align-self-center sm:align-self-end gap-2">
                      <span class="mr-1">
                        <b>Data:</b> 
                        {{ consultancyService.formatDate(item.data_contratacao) }}
                      </span>
                      <span 
                      class="p-error hidden sm:block"
                      [pTooltip]="item.status_assessoria?.nome"
                      tooltipPosition="top"
                      appendTo="body"
                      >
                        <i class="bi bi-exclamation-triangle"></i>
                      </span>
										</div>
                    <div class="flex align-self-center sm:align-self-start gap-2">
											<p-button
                      label="Detalhes"
                      icon="pi pi-list"
                      iconPos="right"
                      [text]="true"
                      [rounded]="true"
											(onClick)="openModal(item.id!, false)"
                      ></p-button>
                      <p-button
                      label="Pendências"
                      icon="pi pi-tags"
                      iconPos="right"
                      [text]="true"
                      [rounded]="true"
											(onClick)="openModal(item.id!, true)"
                      ></p-button>
                    </div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</ng-template>
			</p-dataView>
			<app-consultancy-modal 
			[consultancy]="consultancyService.consultancy_view!"
			[(visible)]="visible"
			[pendencies]="pendency"
			(visibleChange)="onChangeModal($event)"
			></app-consultancy-modal>
		</div>
	</div>
</div>
